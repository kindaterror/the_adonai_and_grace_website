@import url('https://fonts.googleapis.com/css2?family=Baloo+2:wght@600;700&family=Nunito:wght@500;700&display=swap');

/* ==== FULL-PAGE SUN & MOON THEME (book look applied site-wide) ==== */
.sunmoon-theme{
  --sm-deep:#0B1026;
  --sm-dawn:#1d2145;
  --sm-sky:#232a63;
  --sm-amber:#f59e0b; /* sun */
  --sm-amber-deep:#d97706;
  --sm-indigo:#4338ca; /* night highlight */
  --sm-body:'Nunito',system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
  --sm-display:'Baloo 2','Nunito',system-ui,sans-serif;
  color: #eef2ff;
  position:relative; overflow-x:hidden;
  background:
    radial-gradient(1200px 600px at 45% -20%, rgba(245,158,11,0.08), transparent 70%),
    radial-gradient(900px 480px at 80% 0%, rgba(255,255,255,0.10), transparent 75%),
    linear-gradient(180deg, #0c102b 0%, #161a3d 42%, #1f2554 100%);
}
.sunmoon-theme *{ font-family:var(--sm-body); }

/* background layers */
.nc-bg{ position:fixed; inset:0; z-index:0; background-position:center; background-repeat:no-repeat; background-size:cover; opacity:.9; filter: blur(6px) brightness(1.02) saturate(1.05); transform: scale(1.06); pointer-events:none; }
.sm-stars{ position:fixed; inset:0; z-index:0; pointer-events:none; background-image:
  radial-gradient(2px 2px at 20% 30%, rgba(255,255,255,0.8) 50%, transparent 51%),
  radial-gradient(2px 2px at 70% 20%, rgba(255,255,255,0.7) 50%, transparent 51%),
  radial-gradient(1.6px 1.6px at 85% 40%, rgba(255,255,255,0.7) 50%, transparent 51%),
  radial-gradient(1.8px 1.8px at 30% 70%, rgba(255,255,255,0.8) 50%, transparent 51%),
  radial-gradient(2.2px 2.2px at 60% 75%, rgba(255,255,255,0.75) 50%, transparent 51%),
  radial-gradient(1.6px 1.6px at 40% 15%, rgba(255,255,255,0.75) 50%, transparent 51%);
  animation: sm-twinkle 6.5s ease-in-out infinite; opacity:.55; }
@keyframes sm-twinkle{ 0%,100%{transform:translateY(0);opacity:.55} 50%{transform:translateY(-6px);opacity:.9} }

/* page foreground */
.sm-fore{ position:relative; z-index:2; }

/* shared book look components (ported from necklace-comb, recolored) */
.btn-white{ background:#fff!important; color:#111827!important; border:1px solid rgba(255,255,255,0.12)!important; }
.btn-white:hover{ filter:brightness(.98); }
.sm-btn{ border-radius:999px; font-weight:700; }
.sm-heading{ font-family:var(--sm-display); letter-spacing:.2px; }

.nc-figure{ display:grid; grid-template-rows:auto 1fr; gap:12px; z-index:1; position:relative; }
.nc-imageFrame{ position:relative; border-radius:18px; background:#0b0f25; overflow:hidden;
  outline:3px solid rgba(255,255,255,0.35);
  box-shadow: inset 0 0 0 10px rgba(255,255,255,0.18), 0 8px 24px rgba(12,16,37,0.45), 0 3px 12px rgba(12,16,37,0.35);
  background-image:
    radial-gradient(circle at 10px 10px, rgba(255,255,255,0.18) 0 6px, transparent 7px),
    radial-gradient(circle at 32px 10px, rgba(255,255,255,0.18) 0 6px, transparent 7px),
    radial-gradient(circle at 54px 10px, rgba(255,255,255,0.18) 0 6px, transparent 7px);
  background-size:100% 20px; background-repeat:repeat-x; }
.nc-illustration{ width:100%; height:clamp(220px,28vh,290px); object-fit:cover; display:block; }
.nc-corner{ position:absolute; width:28px; height:28px; display:grid; place-items:center;
  background:rgba(255,255,255,0.75); border-radius:8px; color:#1f2937; box-shadow:0 3px 8px rgba(12,16,37,.35); }
.nc-corner--tl{ left:10px; top:10px } .nc-corner--tr{ right:10px; top:10px }
.nc-corner--bl{ left:10px; bottom:10px } .nc-corner--br{ right:10px; bottom:10px }

.nc-caption{ background:rgba(10,12,28,0.78); border:1px solid rgba(255,255,255,0.10); border-radius:16px; padding:14px 16px 16px; text-align:left;
  box-shadow:0 6px 18px rgba(12,16,37,0.45), 0 2px 8px rgba(12,16,37,0.35); min-height:140px; display:grid; gap:6px; }
.nc-narration{ color:#e5e7eb; font-size:.98rem; line-height:1.35; margin:0; }
.nc-dialog{ color:#fde68a; font-style:italic; font-weight:700; margin:0; }

.popup-page-left .story-content, .popup-page-right .story-content{ display:grid; grid-template-rows:auto 1fr; gap:14px; }
.popup-page-nav-left, .popup-page-nav-right{ background:rgba(255,255,255,.92)!important; border:1px solid rgba(255,255,255,.2)!important; color:#111827; }
.popup-page-nav-left:hover, .popup-page-nav-right:hover{ background:#fff!important; box-shadow:0 10px 24px rgba(12,16,37,.45); }

.popup-book-fold{ pointer-events:none; }

.nc-typing{ white-space:pre-wrap; }
.nc-caret{ margin-left:2px; animation:nc-blink 1s steps(1,end) infinite; }
@keyframes nc-blink{ 0%,49%{opacity:1} 50%,100%{opacity:0} }

/* Loader */
.nc-loader{
  /* tie loader palette to the sun & moon theme variables so the loading screen matches the story */
  --nc-loader-top: rgba(245,158,11,0.08); /* light glow using the amber tone */
  --nc-loader-mid: var(--sm-dawn); /* softer mid tone */
  --nc-loader-deep: var(--sm-deep); /* deep page background */
  position:fixed; inset:0; z-index:60; display:grid; place-items:center;
  background: radial-gradient(1200px 700px at 50% -10%, var(--nc-loader-top), transparent 60%),
              linear-gradient(180deg,#0c102b 0%,var(--nc-loader-mid) 45%,var(--nc-loader-deep) 100%);
  transition: opacity .4s ease, visibility .4s ease; }
.nc-loader.hidden{ opacity:0; visibility:hidden; }
.nc-load-card{ width:min(560px,92vw); border-radius:20px; padding:28px 28px 24px; background:#0b0f25;
  box-shadow:0 30px 80px rgba(12,16,37,.65),0 14px 30px rgba(12,16,37,.45),0 6px 14px rgba(12,16,37,.35); text-align:center; border:1px solid rgba(255,255,255,.1); color:#fff; }
.nc-brand{ display:inline-grid; place-items:center; width:96px; height:96px; border-radius:50%;
  background: radial-gradient(var(--sm-amber) 0 45%, rgba(245,158,11,.45) 46% 100%); margin-inline:auto; box-shadow:0 8px 18px rgba(245,158,11,.35); position:relative; }
.nc-beads{ position:absolute; inset:0; animation:nc-rotate 2.8s linear infinite; }
.nc-beads::before,.nc-beads::after{ content:""; position:absolute; top:8px; left:50%; width:8px; height:8px; border-radius:50%; background:#fff; transform:translateX(-50%);
  box-shadow:0 24px 0 0 #fff,0 48px 0 0 #fff,0 72px 0 0 #fff,0 96px 0 0 rgba(255,255,255,.8); opacity:.9; }
.nc-beads::after{ top:16px; opacity:.7; }
@keyframes nc-rotate{ to{ transform:rotate(360deg);} }
.nc-title-xl{ margin:14px 0 4px; font-family:var(--sm-display); font-weight:700; font-size:clamp(22px,2.4vw,28px); color:#fff; letter-spacing:.2px; }
.nc-subtle{ color:#c7d2fe; font-size:.95rem; }
.nc-progress{ margin-top:18px; height:10px; width:100%; border-radius:999px; background:#111827; overflow:hidden; position:relative; border:1px solid rgba(255,255,255,.1); }
.nc-progress>span{ position:absolute; inset:0; transform:translateX(-100%); animation:nc-indeterminate 1.2s cubic-bezier(.22,.61,.36,1) infinite;
  /* use the theme amber colors for the moving highlight so it matches the Sun & Moon palette */
  background: linear-gradient(90deg,
    rgba(245,158,11,0) 0%,
    rgba(245,158,11,0.45) 30%,
    var(--sm-amber) 50%,
    var(--sm-amber-deep) 65%,
    rgba(245,158,11,0) 100%);
  box-shadow: 0 0 18px rgba(245,158,11,.15); }
@keyframes nc-indeterminate{ 0%{transform:translateX(-100%)} 100%{transform:translateX(100%)} }

/* Entrance / lift / opening clips (same behavior) */
.nc-enter{ opacity:0; transform:translateY(12px) scale(.985); }
.nc-enter.nc-enter-active{ opacity:1; transform:translateY(0) scale(1); transition:opacity .45s ease, transform .45s ease; }
.popup-open-book-wrapper.nc-enter.nc-enter-active .popup-flip-book-container .popup-book-wrapper{ animation:nc-lift 420ms cubic-bezier(.2,.9,.2,1) 60ms both; }
@keyframes nc-lift{ from{ transform:translateY(6px) scale(.992);} to{ transform:translateY(0) scale(1);} }

.popup-book-wrapper.nc-opening{ will-change: transform; }
.popup-book-wrapper.nc-opening .popup-page-left,
.popup-book-wrapper.nc-opening .popup-page-right{ overflow:hidden; }
.popup-book-wrapper.nc-opening .popup-page-left{ clip-path: inset(0 50% 0 0 round 12px); animation: nc-open-left 950ms cubic-bezier(.19,1,.22,1) both; }
.popup-book-wrapper.nc-opening .popup-page-right{ clip-path: inset(0 0 0 50% round 12px); animation: nc-open-right 950ms cubic-bezier(.19,1,.22,1) both; animation-delay: 20ms; }
@keyframes nc-open-left{ 0%{ clip-path: inset(0 50% 0 0 round 12px); } 55%{ clip-path: inset(0 6% 0 0 round 12px); } 100%{ clip-path: inset(0 0 0 0 round 12px); } }
@keyframes nc-open-right{ 0%{ clip-path: inset(0 0 0 50% round 12px); } 55%{ clip-path: inset(0 0 0 6% round 12px); } 100%{ clip-path: inset(0 0 0 0 round 12px); } }

/* Finale tweaks */
/* Center finale modal vertically instead of pushing it high */
.nc-finale-open [data-state="open"].fixed.inset-0.z-50.flex.items-center.justify-center{ align-items:center !important; padding-top:0 !important; }
.nc-finale-lift{ transform: translate(-50%, -50%) !important; top:50% !important; left:50% !important; position:fixed !important; }
@media (min-width: 768px){  .nc-finale-lift{ transform: translate(-50%, -50%) !important; } }
@media (min-width: 1024px){ .nc-finale-lift{ transform: translate(-50%, -50%) !important; } }
.nc-finale-box{ position:relative; overflow:auto; border-radius:18px; border:2px solid rgba(255,255,255,.12); margin:0 !important; max-height: min(78vh, 78svh) !important; scrollbar-gutter: stable both-edges; background:#0b0f25; color:#e5e7eb; }
@media (max-width: 640px){ .nc-finale-box{ max-height: min(86vh, 86svh) !important; } }
.nc-finale-box::before{ content:""; position:absolute; inset:-6px; pointer-events:none; border-radius:22px; background:
    radial-gradient(6px 6px at 6% 12%, #fff 60%, transparent 62%),
    radial-gradient(6px 6px at 12% 8%, #fff 60%, transparent 62%),
    radial-gradient(6px 6px at 18% 12%, #fff 60%, transparent 62%),
    radial-gradient(6px 6px at 24% 8%, #fff 60%, transparent 62%),
    radial-gradient(6px 6px at 30% 12%, #fff 60%, transparent 62%),
    radial-gradient(6px 6px at 36% 8%, #fff 60%, transparent 62%),
    radial-gradient(6px 6px at 42% 12%, #fff 60%, transparent 62%),
    radial-gradient(6px 6px at 48% 8%, #fff 60%, transparent 62%),
    radial-gradient(6px 6px at 54% 12%, #fff 60%, transparent 62%),
    radial-gradient(6px 6px at 60% 8%, #fff 60%, transparent 62%),
    radial-gradient(6px 6px at 66% 12%, #fff 60%, transparent 62%),
    radial-gradient(6px 6px at 72% 8%, #fff 60%, transparent 62%),
    radial-gradient(6px 6px at 78% 12%, #fff 60%, transparent 62%),
    radial-gradient(6px 6px at 84% 8%, #fff 60%, transparent 62%),
    radial-gradient(6px 6px at 90% 12%, #fff 60%, transparent 62%);
  box-shadow: inset 0 0 0 999px rgba(67,56,202,0.10); }

.nc-finale-badge{ width:80px; height:80px; position:relative; display:grid; place-items:center; margin:0 auto 6px; }
.nc-finale-moon{ width:56px; height:56px; border-radius:50%; background: radial-gradient(circle at 30% 30%, #fff 0 50%, rgba(255,255,255,.6) 60%, rgba(255,255,255,0) 61%); box-shadow:0 0 0 6px rgba(255,255,255,.5), 0 6px 16px rgba(12,16,37,.6); }
.nc-finale-beads{ position:absolute; inset:0; }
.nc-finale-beads::before{ content:""; position:absolute; left:50%; top:-6px; transform:translateX(-50%); width:6px; height:6px; background:#fff; border-radius:50%; box-shadow: 0 14px 0 0 #fff, 0 28px 0 0 #fff, 0 42px 0 0 #fff, 0 56px 0 0 #fff; }

.nc-comb-divider{ height:12px; margin:12px 0; background: linear-gradient(90deg, rgba(67,56,202,.18) 0 10%, transparent 10% 12%, rgba(67,56,202,.18) 12% 22%, transparent 22% 24%) repeat-x; background-size:40px 12px; border-radius:6px; }

.nc-finale-btn-primary{ background:linear-gradient(180deg, var(--sm-amber), var(--sm-amber-deep))!important; color:#111827!important; border:1px solid rgba(255,255,255,.12)!important; }
.nc-finale-btn-primary:hover{ filter:brightness(0.97); }
.nc-finale-btn-outline{ background:#fff!important; color:#111827!important; border:1px solid rgba(255,255,255,.2)!important; }

/* Video and live2d fills (prevent letterboxing + white blocks) */
.nc-video, .nc-live2d, .nc-illustration { width:100%; height:100%; object-fit:cover; display:block; }
.nc-imageFrame { aspect-ratio: 16/9; height: clamp(220px,28vh,290px); }

/* Loader skeleton */
.nc-skeleton-spread{ display:grid; grid-template-columns: 1fr 1fr; gap:16px; }
.nc-skeleton-page{ height:360px; border-radius:14px; background:linear-gradient(90deg, rgba(255,255,255,0.03), rgba(255,255,255,0.06) 40%, rgba(255,255,255,0.03)); box-shadow: inset 0 0 0 6px rgba(255,255,255,0.02); }

/* minor tweaks to avoid white bleed on some browsers */
.nc-imageFrame > video { background: transparent; }
.nc-imageFrame > img { background: transparent; }
